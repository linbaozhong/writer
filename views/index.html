<!DOCTYPE html>

<html>

	<head>
		<title>非线性协作</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<link rel="stylesheet" type="text/css" href="../static/css/pinghei.css" />
		<link rel="stylesheet" type="text/css" href="../static/css/iconFont.min.css" />
		<link rel="stylesheet" type="text/css" href="../static/css/metro-bootstrap.min.css" />
		<script src="../static/js/jquery-2.1.1.min.js" type="text/javascript" charset="utf-8"></script>
		<link rel="stylesheet" type="text/css" href="../static/css/jquery.mCustomScrollbar.min.css" />
		<script src="../static/js/jquery.mCustomScrollbar.concat.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../static/js/jquery.accordion.0.1.js" type="text/javascript" charset="utf-8"></script>
		<script src="../static/js/jquery.widget.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../static/js/metro-loader.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			body,
			div,
			dl,
			dt,
			dd,
			ul,
			ol,
			li,
			pre,
			code,
			form,
			fieldset,
			legend,
			input,
			textarea,
			blockquote,
			th,
			td,
			hr,
			article,
			aside,
			details,
			figcaption,
			figure,
			footer,
			header,
			hgroup,
			menu,
			nav,
			b,strong,section {
				font-family: "PingHei 200" !important;
			}
			h1,h2,h3,h4,h5,h6
			{
				font-family: "PingHei 600" !important;
			}
			p {
				font-family: "PingHei 400" !important;
			}
			body {
				background-size: cover;
			}
			nav {
				position: fixed;
				width: 75px;
				top: 0;
				right: 0;
				bottom: 0;
				padding: 50px 0;
				z-index: 1000;
				/*display: none;*/
			}
			div.nav-info-box {
				z-index: 900;
			}
			div.nav-info {
				z-index: 901;
				color: white !important;
			}
			div.nav-info,
			div.nav-info-box {
				position: fixed;
				top: 0;
				bottom: 0;
				right: -1000px;
				width: auto;
			}
			#snow-sign {
				position: fixed;
				left: 0;
				right: 0;
				top: 0;
				height: 100%;
				width: 400px;
				margin: 0 auto;
				color: white !important;
				z-index: 1000;
			}
			/*左侧框*/
			
			#snow-left {
				position: fixed;
				height: 100%;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
				/*margin-left: 20px;*/
				
				z-index: 1;
			}
			#snow-left .content {} #snow-left .content,
			#snow-right .content {
				height: 100%;
				position: relative;
				max-width: 700px;
				min-width: 300px;
				padding: 0 20px;
				width: 100%;
			}
			/*右侧框*/
			
			#snow-right {
				display: none;
				position: fixed;
				height: 100%;
				top: 0;
				bottom: 0;
				right: 0;
				width: 1000px;
				z-index: 1;
			}
			#snow-right .content {
				/*margin: 0 40px 0 20px;*/
			}
			/*列表项*/
			
			.horizontal-list ul,
			.horizontal-list dl {
				margin: 0;
				padding: 0;
				list-style: none;
				outline: none;
				overflow: hidden;
				width: 100%;
			}
			.horizontal-list ul li {
				/*font-size: .8em !important;*/
				
				float: left;
				overflow: hidden;
				text-align: right;
				text-overflow: ellipsis;
				white-space: nowrap;
				padding: 0 4px;
				display: block;
				cursor: pointer;
			}
			.horizontal-list ul li:hover {
				background: #1ba1e2 !important;
				color: #ffffff !important;
			}
			.horizontal-list ul li.active {
				background: #1ba1e2 !important;
				color: #ffffff !important;
			}
			.horizontal-list dl dt {
				font-weight: bold;
			}
			.horizontal-list dl dt,
			.horizontal-list dl dd {
				float: left;
			}
			.horizontal-list dl:after {
				clear: both;
				content: "";
			}
			/*.doclist*/
			
			.doclist {
				text-align: left;
			}
			/*.doclist .doc:nth-child(2n+1){
				background:#eee;
			}*/
			
			.doclist .doc {
				padding: 20px 20px;
				width: 100%;
				cursor: pointer;
				position: relative;
			}
			.doclist .doc.active {
				background: #eee;
			}
			.doclist .doc h1 {
				font-size: 1.4em;
			}
			.doclist .doc h2 {
				font-size: 1.3em;
			}
			.doclist .doc h3 {
				font-size: 1.2em;
			}
			.doclist .doc h4 {
				font-size: 1.1em;
			}
			.doclist .doc h5,
			.doclist .doc h6 {
				font-size: 1em;
			}
			.doclist .doc h1,
			.doclist .doc h2,
			.doclist .doc h3,
			.doclist .doc h4,
			.doclist .doc h5,
			.doclist .doc h6 {
				font-weight: bold;
				line-height: initial;
				margin: 0 0 .8em;
				color: gray;
			}
			.doclist .doc .doc-content {
				font-size: 1.1em;
				margin: 0 0 .5em;
			}
			.doclist .doc .doc-remark {
				font-size: .8em;
				color: gray;
			}
			.doclist .doc .tools {
				margin: 4px 0 0 10px;
				color: gray;
			}
			.doclist .doc .tools.del,
			.doclist .doc .tools.edit {
				font-size: 12px;
				margin: 5px;
				display: none;
			}
			.doclist .doc .tools.edit {
				margin: 5px 30px 5px 5px;
			}
			.doclist div.doc:hover {
				background: #eee;
			}
			.doclist div.doc:hover .tools.del,
			.doclist .doc:hover .tools.edit {
				display: block;
			}
			.doclist div.doc .tools i {
				font-size: 10px;
			}
			.doclist .user-input {
				padding: 20px 0;
			}
			.doclist .user-input .textarea {
				margin: 0;
			}
			.doclist .user-input.editing {
				padding: 20px;
				margin: 20px 0;
				background: #999;
			}
			.doclist .user-input textarea {
				height: 2em;
				min-height: 2em !important;
				resize: none;
				overflow: hidden;
			}
			.doclist .user-input.editing textarea {
				margin-bottom: 10px;
				resize: none;
				overflow: auto;
			}
			.doclist .user-input .form-actions {
				display: none;
			}
			.doclist .user-input.editing .form-actions {
				display: block;
			}
			/*metro*/
			
			.metro form {
				margin: initial;
			}
		</style>
		<style type="text/css">
			.accordion {
				border: 1px solid #EEEEEE;
			}
			.accordion.horizontal::after {
				clear: both;
				content: " ";
			}
			.accordion.horizontal .frame .heading {} .accordion.horizontal .frame .content {} .accordion.horizontal .frame .content::after {} .accordion .frame {
				background: #fff;
			}
			.accordion .frame .heading {
				background: #eee;
			}
			.accordion .frame .content {
				border-left: 1px solid #EEEEEE;
				padding: 5px;
			}
			.accordion .frame.active .content {}
		</style>
	</head>

	<body class="metro">
		<!--左侧导航条-->
		<nav class="bg-dark fg-white shadow">
			<div style="padding:10px;">
				<div class="tile half bg-cyan" data-hint="登录/注册" data-hint-position="left" data-click="transform" data-role="1" data-rel="signin">
					<div class="tile-content icon">
						<i class="icon-key-2"></i>
					</div>
				</div>
				<!--书签-->
				<div class="tile half bg-cyan" data-hint="书签" data-hint-position="left" data-click="transform" data-role="0" data-rel="bookmarks">
					<div class="tile-content icon">
						<i class="icon-air"></i>
					</div>
				</div>

			</div>
		</nav>
		<!--导航条弹出框-->
		<div class="nav-info-box bg-gray opacity">

		</div>
		<div class="nav-info">

		</div>
		<!--中间的注册登录框-->
		<div id="snow-sign" class="bg-gray opacity">
			<div class="user-sign">
				<a href="javascript:;" class="getout icon-cancel-2 place-top-right margin5 fg-white border padding5" style="border-radius: 50%;">
				</a>
				<div class="padding20">
					<h2 class="padding10 fg-white">使用合作网站账户登录</h2>
					<div class="form-actions">
						<div class="horizontal-list">
							<ul>
								<li class="padding5 margin5 fg-white" id="qqLogin">QQ</li>
								<li class="padding5 margin5 fg-white">新浪微博(暂不可用)</li>
							</ul>
						</div>
					</div>
				</div>
				<hr />
				<div class="" data-load="signin">

				</div>
				<hr />
				<div class="" data-load="signup">

				</div>
				<hr />
				<div class="padding20 margin10">
					<button type="button" class="getout button primary large" style="width: 100%;font-weight: bold;">爷就这么任性</button>
				</div>
			</div>
		</div>
		<!--左侧框--工作区-->
		<div id="snow-left" class="bg-white">
			<div class="chouti" style="height:100%;">
				<div class="frame">
					<div class="content">
						<form class="doc user-input native">
							<input type="hidden" name="id" id="doc-id" value="" />
							<div class="input-control textarea">
								<textarea name="content" rows="" cols="" placeholder="写点儿什么……"></textarea>
							</div>
							<div class="form-actions input-control text">
								<input type="text" name="tags" id="tags" value="" placeholder="标签" />
							</div>
							<div class="form-actions text-right">
								<button name="btn-save" type="button" data-role="0" class="button primary">保存</button>
								<button name="btn-cancel" type="button" data-role="0" class="button">取消</button>
							</div>
						</form>
						<div class="doclist">
							<div class="doc" data-id="1">
								<div class="doc-content">
									<h1>

							标题标题标题标题标题标题

						</h1>
									<p>正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
								</div>
								<div>
									<a href="javascript:;" class="tools del icon-cancel-2 place-top-right">
									</a>
									<a href="javascript:;" class="tools edit icon-pencil place-top-right">
									</a>
									<span class="doc-remark">备注 备注 备注</span>
									<span class="tools place-right icon-heart-2"><i>123</i></span>
									<span class="tools place-right icon-new-tab"><i>456</i></span>
								</div>

							</div>
							<div class="doc">
								<div class="doc-content">
									<h2>

							标题标题标题标题标题标题

						</h2>
									<p>正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
								</div>
								<div>
									<a href="javascript:;" class="tools del icon-cancel-2 place-top-right">
									</a>
									<a href="javascript:;" class="tools edit icon-pencil place-top-right">
									</a> <span class="doc-remark">备注 备注 备注</span>
									<span class="tools place-right icon-heart-2"><i>123</i></span>
									<span class="tools place-right icon-new-tab"><i>456</i></span>
								</div>
							</div>
							<div class="doc">
								<div class="doc-content">
									<h3>

							标题标题标题标题标题标题

						</h3>
									<p>正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
								</div>
								<div>
									<a href="javascript:;" class="tools del icon-cancel-2 place-top-right">
									</a>
									<a href="javascript:;" class="tools edit icon-pencil place-top-right">
									</a> <span class="doc-remark">备注 备注 备注</span>
									<span class="tools place-right icon-heart-2"><i>123</i></span>
									<span class="tools place-right icon-new-tab"><i>456</i></span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--右侧框--工作区-->
		<div id="snow-right" class="bg-white">

			<div class="content">
				<div class="doclist">
					<div class="doc">
						<div class="doc-content">
							<h1>

							标题标题标题标题标题标题

						</h1>
							<p>正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
						</div>
						<div class="doc-remark">
							备注 备注 备注
						</div>
					</div>

					<div class="doc">
						<div class="doc-content">
							<h2>

							标题标题标题标题标题标题

						</h2>
							<p>正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
						</div>
						<div class="doc-remark">
							备注 备注 备注
						</div>
					</div>
					<div class="doc">
						<div class="doc-content">
							<h3>

							标题标题标题标题标题标题

						</h3>
							<p>正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
						</div>
						<div class="doc-remark">
							备注 备注 备注
						</div>
					</div>
				</div>
			</div>

		</div>
	</body>

</html>
<script type="text/javascript">
	var snow = {
		speed: 300,
		width: $(window).width(),
		log: function() {
			console.log(arguments);
		},
		inc: function() {
			return '../static/inc/_' + arguments[0] + '.html';
		}
	};

	//隐藏位置
	snow.hidden = {
		left: -1000,
		right: -1000
	};
	//

	// 导航条
	snow.nav = $('nav');
	snow.nav.width = snow.nav.width();
	//注册登录框
	snow.sign = $('#snow-sign').css({
		width: 400,
		right: snow.nav.width
	});

	/*
	 * 解决传统浏览器不支持placeholder问题
	 */
	function placeholder() {

		if (!('placeholder' in document.createElement('input'))) {

			$('input[placeholder],textarea[placeholder]').each(function() {

				var that = $(this),
					text = that.attr('placeholder');

				if (that.val() === "") {
					that.val(text).addClass('placeholder');
				}
				that.focus(function() {
					if (that.val() === text) {
						that.val("").removeClass('placeholder');
					}
				}).blur(function() {
					if (that.val() === "") {
						that.val(text).addClass('placeholder');
					}
				}).closest('form').submit(function() {
					if (that.val() === text) {
						that.val('');
					}
				});
			});
		}
	};
	/*
	 * 页面数据拉取
	 */
	function dataLoading() {
		$('[data-load]').each(function() {
			var _this = $(this),
				_data = _this.data('load');
			if (_data && _data.length > 0) {
				_this.load(snow.inc(_this.data('load')));
			}
		});
	};

	//打开登录注册框
	function openSign() {
		if (!snow.sign.hasClass('active')) {
			snow.sign.animate({
				top: 0
			}, snow.speed, function() {
				snow.sign.addClass('active');
			});
		}
	}

	$(function() {
		setTimeout(function() {
			// 拉取数据
			dataLoading();
			// 解决传统浏览器不支持placeholder问题
			placeholder();
			//打开登录注册框
			openSign();
			//
			var chouti = snow.left.find('div.chouti').accordion({
				horizontal: true
			}).add({
				title: '',
				url: 'it.htm',
				active: false
			});

			//chouti.up();
			//
			$("div.content").mCustomScrollbar({
				theme: 'minimal-dark',
				axis: 'y',
				//autoHideScrollbar: true,
				scrollbarPosition: 'inside',
				mouseWheel: {
					scrollAmount: 500
				}
			});
			// 选中第一个文档
			snow.left.find('.doclist div.doc').eq(0).click();

		}, 100);
		// 导航条---事件
		snow.nav.on('click', '.tile', function(e) {
			var _that = $(this);
			if (_that.data('rel') == 'signin') {
				openSign();
			} else {
				//
				$('div.nav-info').load(snow.inc(_that.data('rel')), function() {
					$('div.nav-info-box').css({
						width: $('div.nav-info').eq(0).width()
					});
				});
				$('div.nav-info-box,div.nav-info').animate({
					right: snow.nav.width
				});
			}
		});

		//关闭登陆框
		$(".getout").click(function() {
			snow.sign
				.removeClass('active')
				.animate({
					top: '-2000px'
				}, snow.speed, function() {
					if (snow.nav.is(':hidden')) {
						snow.nav.animate({
							right: 0
						}, snow.speed).show();
					}
				});
		});

		// 文档编辑框
		var _native = snow.left.find('form.native').eq(0).click(function(e) {
			if (snow.left.find('form.editing').length > 0) {
				return;
			}
			var _doc = $(this);
			if (_doc.hasClass('editing') && _doc.find('textarea').val() == '') {
				// 复原
				//				_doc.find('textarea').animate({
				//					height: '2em'
				//				}, snow.speed, function() {
				//					_doc.removeClass('editing');
				//				}).val('').blur();
			} else if (!_doc.hasClass('editing')) {
				_doc.addClass('editing').find('textarea').animate({
					height: '20em'
				}, snow.speed);
			}
		}).on('click', 'button', function(e) { //表单保存(取消)事件
			e.stopPropagation();
			var _that = $(this),
				_frm = _that.closest('form.user-input');
			if (_that.attr('name') == 'btn-save') { //保存

			} else { //取消
				// 复原
				_frm.removeClass('editing').find('textarea').animate({
					height: '2em'
				}, snow.speed).val('');
			}
			// 如果是修改表单
			if (_frm.hasClass('editor')) {
				_frm.prev('div.doc').show();
				_frm.hide();
			}
		});

		var _clone = _native.clone(true).removeClass('native').addClass('clone');
		var _editor = _native.clone(true).removeClass('native').addClass('editor');

		snow.left.find('.doclist').on('click', 'div.doc', function(e) {
			var _doc = $(this);

			// 复原编辑表单
			if (!_doc.hasClass('active')) {
				var _old = _doc.siblings('.active').removeClass('active');

				_native.removeClass('editing').find('textarea').css({
					height: '2em'
				});
				_clone.removeClass('editing').find('textarea').css({
					height: '2em'
				});
				// 激活doc
				_doc.addClass('active');

			}
			// 检查前后是否有新文档表单
			if (!_doc.prev().hasClass('native')) {
				_native.find('textarea').val('');
				_doc.before(_native);
			}
			if (!_doc.next().hasClass('clone')) {
				_clone.find('textarea').val('');
				_doc.after(_clone);
			}
			_native.show();
			_clone.show();
		}).on('click', '.tools.del', function(e) {

			e.stopPropagation();
			var _doc = $(this).closest('div.doc');

			// 检查前后是否有新文档表单
			if (_doc.prev().hasClass('native') && _doc.siblings('div.doc').length > 0) {
				_doc.prev().hide();
			}
			if (_doc.next().hasClass('clone')) {
				_doc.next().hide();
			}
			_doc.remove();
		}).on('click', '.tools.edit', function(e) {

			e.stopPropagation();
			if (snow.left.find('form.editing').length > 0) {
				return;
			}
			var _doc = $(this).closest('div.doc').hide();
			//
			_doc.after(_editor.show().click());
		});

	});

	//
	$(window).resize(function() {
		// 窗体宽度
		snow.width = $(this).width();
		// 左侧工作区
		snow.left = $('#snow-left').css({
			//width: (snow.width - snow.nav.width - 20) / 2,
			right: snow.nav.width
		});
		// 右侧工作区
		//		snow.right = $("#snow-right").css({
		//			width: (snow.width - snow.nav.width - 20) / 2
		//		});
		//		if (snow.sign.hasClass('active')) {
		//			//
		//			$('#snow-left,#snow-right').css({
		//				width: (snow.width - snow.nav.width - snow.sign.width() - 20) / 2
		//			});
		//		}
	}).resize();
</script>